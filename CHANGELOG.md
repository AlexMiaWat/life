# Changelog

Все значимые изменения в проекте Life документируются в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [Unreleased]

## [2026-01-20] - Реализация субъективного времени как сквозной оси жизни

### Добавлено
- **Субъективное время в памяти:** Добавлено поле `subjective_timestamp` в `MemoryEntry` для записи субъективного времени создания записи
- **Интеграция в Runtime Loop:** Субъективное время записывается при создании всех записей памяти (обычные события и Feedback)
- **Обновление мониторинга:** Консольный вывод показывает физическое и субъективное время (`возраст: {age}/{subjective_time} сек.`)
- **Тесты обратной совместимости:** Добавлены тесты для загрузки старых snapshot/memory файлов без поля `subjective_timestamp`
- **Интеграционные тесты:** Добавлены тесты для проверки записи субъективного времени в память и Feedback записи

### Изменено
- **MemoryEntry:** Добавлено поле `subjective_timestamp: Optional[float] = None` с обратной совместимостью
- **Runtime Loop:** Обновлена логика создания MemoryEntry для записи субъективного времени
- **Мониторинг:** Обновлен консольный вывод и логирование `tick_log.jsonl` для отображения обоих временных шкал
- **SelfState API:** Улучшен метод `get_safe_status_dict()` для надежной сериализации состояния

### Технические детали
- Добавлено 6 новых unit-тестов для MemoryEntry с subjective_timestamp
- Добавлено 3 интеграционных теста для проверки работы субъективного времени в памяти
- Обеспечена обратная совместимость: старые файлы загружаются корректно, новые сохраняют поле
- Все изменения следуют архитектурным принципам: субъективное время остается метрикой, не используется для управления

---

## [2026-01-20] - Улучшения тестирования и логирования

### Добавлено
- **Новые unit-тесты для Runtime Loop:** Добавлены тесты делегирования и отсутствия регрессий
  - `TestRunLoopDelegation` - проверка делегирования вызовов в менеджеры
  - `TestNoRegressionBehavior` - проверка отсутствия регрессий поведения
  - `TestRunLoopCoordination` - интеграционные тесты координации менеджеров
- **Улучшенное логирование:** Замена `print()` на структурированное логирование с уровнями

### Изменено
- **Runtime Loop (v2.0):** Улучшения логирования, выделение менеджеров (SnapshotManager, LogManager, LifePolicy)
- **Тестирование:** Добавлено 7 новых тестов для проверки делегирования и отсутствия регрессий

### Технические детали
- Добавлено 7 новых unit-тестов в `src/test/test_runtime_loop_managers.py`
- Все тесты проходят успешно
- Улучшена тестируемость Runtime Loop через изоляцию менеджеров
- Убраны `print()` из hot-path для улучшения производительности

---

## [2026-01-20] - Оптимизация документации

### Изменено
- **Оптимизация документации:** Объединены короткие документы, удалены устаревшие файлы
- **Удален устаревший файл:** `docs/development/NOW.md` (файл был помечен как устаревший)
- **Обновлены индексы:** `docs/README.md` и `docs/INDEX.md` обновлены с актуальными ссылками
- **Создан CHANGELOG.md:** Добавлен файл для отслеживания изменений проекта

### Статистика оптимизации
- **Файлов до:** 121
- **Файлов после:** 120
- **Удалено:** 1 устаревший файл
- **Размер документации:** 1.9M (без изменений)

### Детали
- Удален `docs/development/NOW.md` — файл был помечен как устаревший, актуальная информация находится в `docs/development/status.md`
- Обновлены ссылки в индексах документации
- Проверены и обновлены все ссылки на удаленные файлы

---

## [2026-01-26] - Предыдущие изменения

### Добавлено
- Компонент Adaptation (v1.0) — медленная перестройка поведения на основе статистики Learning
- Компонент Learning (v1.0) — медленное изменение внутренних параметров
- API с аутентификацией (`api.py`) — JWT токены, регистрация, защищенные endpoints
- Тесты для Adaptation, Learning и деградации системы

### Обновлено
- Документация компонентов и статусов
