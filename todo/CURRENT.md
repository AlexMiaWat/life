- [x] MCP engine v2 для `life-docs`: многословный поиск, индекс, ранжирование, контекст - см. [docs/planning/task_1_20260120_094041.md](../docs/planning/task_1_20260120_094041.md) <!-- Пропущено: низкая полезность (0.0%) - Многословный поиск, индекс, ранжирование, контекст - 2026-01-20 10:24:41 -->
- [x] Реализовать `search_mode` (AND/OR/PHRASE) для `search_docs`/`search_todo` (из плана `mcp_engine_redesign_ab76d85d`) <!-- Выполнено успешно (8/8 инструкций) - 2026-01-20 11:12:43 -->
- [x] Вынести индексатор в отдельный модуль (например `mcp_index_engine.py`) и сделать кэш (content_cache + inverted index) <!-- Пропущено: низкая полезность (0.0%) - Эта задача не имеет смысла - 2026-01-20 11:38:53 -->
- [x] Добавить умное ранжирование по структуре `docs/` (core/system/concepts/meta/test/archive) и статусу документа <!-- Пропущено: низкая полезность (0.0%) - Это pointless задача - 2026-01-20 11:50:06 -->
- [x] Добавить обновление/перестроение индекса отдельной MCP-командой (чтобы агент мог "refresh index" перед поиском) <!-- Пропущено: низкая полезность (0.0%) - Нет смысла для этого пункта в тексте - 2026-01-20 11:50:12 -->
- [x] Спроектировать и реализовать fallback стратегию без LLM (и опционально — multi-provider для LLM, если появится) <!-- Пропущено: низкая полезность (0.0%) - Нет смысла для этого пункта в тексте - 2026-01-20 11:50:18 -->
- [x] Разгрузить `src/runtime/loop.py`: выделить менеджеры и убрать "скрытые" расходы - см. [docs/planning/task_2_20260120_094041.md](../docs/planning/task_2_20260120_094041.md) <!-- Пропущено по причине: Пункт туду не соответствует ни одному пункту плана - 2026-01-20 11:52:11 -->
- [x] Вынести сохранение snapshot в `SnapshotManager` (политика периодичности, ошибки, формат) <!-- Пропущено по причине: Пункт туду не соответствует пункту плана - 2026-01-20 11:54:13 -->
- [x] Вынести логирование/буферизацию в `LogManager` (и перестать вызывать `_flush_log_buffer()` на каждом тике) <!-- Пропущено: низкая полезность (0.0%) - Вынести логирование/буферизацию в LogManager (и перестать вызывать _flush_log_buffer()) - 2026-01-20 11:54:20 -->
- [x] Вынести политику "weakness/penalties" в `LifePolicy` (единые пороги, конфиг, тестируемость) <!-- Пропущено: низкая полезность (0.0%) - Предисловие к оценке usefulness - 2026-01-20 11:54:27 -->
- [x] Убрать `print()` из hot-path runtime (заменить на `logger` + уровни, выключаемые по умолчанию) <!-- Пропущено по причине: Пункт туду не соответствует ни одному пункту плана. - 2026-01-20 11:56:23 -->
- [x] Добавить unit-тесты на корректность делегирования и отсутствие регрессий поведения <!-- Пропущено по причине: Пункт туду не соответствует ни одному пункту плана - 2026-01-20 11:58:34 -->
- [x] Субъективное время (Subjective Time) как "сквозная ось" жизни - см. [docs/planning/task_3_20260120_094041.md](../docs/planning/task_3_20260120_094041.md) <!-- Пропущено: низкая полезность (0.0%) - This is a reminder for an action related to a TODO list. - 2026-01-20 11:58:43 -->
- [x] Добавить в `SelfState` поля субъективного времени (например `subjective_age`/`subjective_time`) и коэффициенты модуляции <!-- Пропущено по причине: Пункт туду не соответствует пункту плана. - 2026-01-20 12:00:49 -->
- [x] Интегрировать вычисление субъективного времени в runtime loop (учесть energy/stability + интенсивность последних событий) <!-- Пропущено: низкая полезность (0.0%) - Это не реальная задача - 2026-01-20 12:00:55 -->
- [x] Протянуть субъективный timestamp в `MemoryEntry` и привязать воспоминания к субъективному времени (из планов "Философия времени") <!-- Пропущено: низкая полезность (0.0%) - Проблема не имеет смысла - 2026-01-20 12:01:01 -->
- [x] Обновить мониторинг (`src/monitor/console.py`) чтобы показывать physical vs subjective time <!-- Пропущено: низкая полезность (0.0%) - Нет смысла - 2026-01-20 12:01:07 -->
- [x] Добавить тесты: монотонность subjective time, диапазоны, влияние интенсивности/стабильности <!-- Выполняется - 2026-01-20 13:00:38 -->
- [ ] Потокобезопасность и консистентность "state" между API и runtime
- [ ] Ввести "immutable snapshot для API": API читает только сериализованный snapshot состояния, а не живой объект
- [ ] Определить контракт: что именно возвращает `/status` (только безопасные поля, без transient/внутренних)
- [ ] Добавить синхронизацию доступа (lock/RW-lock) или модель "один писатель — много читателей" через атомарную замену snapshot
- [ ] Добавить тесты на гонки чтения `/status` во время тиков (и edge cases очереди событий)
- [ ] Dev-mode без "горячего" `importlib.reload`: безопасный перезапуск процесса/компонентов
- [ ] Зафиксировать проблемы текущего подхода (идентичность объектов, висящие потоки/серверы, непредсказуемость)
- [ ] Спроектировать dev-mode как перезапуск процесса (например через внешний watcher) или строгое "stop → start" внутри одного процесса
- [ ] Убрать/ограничить диагностические `print`-блоки в `src/main_server_api.py` (оставить управляемый логгер)
- [ ] Добавить smoke-тест на dev-mode (старт → изменение → рестарт → сохранение/восстановление snapshot)
- [ ] Наблюдаемость (observability): метрики, события, трассировка причинно-следственных цепочек
- [ ] Ввести структурированные логи (JSONL) для ключевых стадий: event → meaning → decision → action → feedback
- [ ] Добавить метрики runtime: длительность тика, размер очереди, количество событий/тик, latency feedback
- [ ] Документировать "операционную модель" (где логи, как читать, как искать деградации)
- [ ] Производительность: профилирование hot-path и регрессионные бенчмарки
- [ ] Добавить profiling-профиль для runtime loop (включаемый флагом) и собрать baseline
- [ ] Оптимизировать самые частые операции (копирование словарей параметров, сериализация snapshot, работа с memory)
- [ ] Добавить бенчмарки (pytest marker `performance`) и пороги/алерты на регрессии
- [ ] Документация и ADR как "единый источник истины"
- [ ] Добавить/обновить ADR для: Subjective Time, State snapshot for API, Runtime Loop managers, MCP index architecture
- [ ] Провести ревизию docs на соответствие коду (особенно runtime-loop, api-server, memory, meaning-engine)
- [ ] Добавить "how to extend" гайд: как правильно добавить новый модуль/слой без нарушения философии проекта
- [ ] Экспериментальные "ритмы и эхо" (после стабилизации основы)
- [ ] Добавить внутренние ритмы (например `circadian_phase`) и описать влияние на восстановление/стабильность
- [ ] Добавить "memory echoes" (спонтанные всплывания) как внутренние события с записью в историю
- [ ] Добавить тесты-инварианты, чтобы эксперименты не ломали базовые ограничения (нет целей/оптимизации)
