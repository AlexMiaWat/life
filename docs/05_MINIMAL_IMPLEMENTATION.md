# 05_MINIMAL_IMPLEMENTATION.md

## Назначение

Этот документ описывает **минимально допустимую реализацию** life.

Не красивую.
Не умную.
Не удобную.

А **архитектурно корректную**.

Цель этапа:

> получить реально запущенный процесс, который существует во времени, изменяется и может завершиться.

---

## Принцип этапа

На этом этапе:

* мы не расширяем архитектуру
* мы не добавляем новые концепции
* мы не оптимизируем

Мы **реализуем только то, что уже зафиксировано в документах 01–04**.

Любая идея, не описанная ранее — откладывается.

---

## Минимальный состав файлов

```
life/
└── src/
    ├── main_server_api.py
    ├── runtime/
    │   └── loop.py
    ├── state/
    │   ├── self_state.py
    │   └── self_snapshot.py
    └── monitor/
        └── console.py
```

Никаких дополнительных модулей.

---

## main_server_api.py

Ответственность:

* инициализация life
* запуск Runtime Loop в отдельном потоке
* запуск API сервера в отдельном потоке
* поддержка dev mode с auto-reload
* корректное завершение

Запреты:

* никакой логики жизни
* никакой визуализации (кроме консольного monitor)

---

## Runtime Loop (loop.py)

Минимальная реализация:

* while alive
* измерение dt
* вызов шагов тика
* обработка исключений

Фиксированные параметры:

* dt_target = 1.0 сек
* без адаптивности

---

## Self-State (self_state.py)

Минимальный набор параметров:

* life_id
* birth_timestamp
* age
* energy
* integrity
* stability
* tick_count

Начальные значения:

* energy = 100
* integrity = 1.0
* stability = 1.0

---

## Правила обновления Self-State

На каждом тике:

* age += dt
* tick_count += 1
* energy -= 0.1
* stability -= 0.001

При исключении:

* integrity -= 0.05

Если любой параметр ≤ 0 → alive = False

---

## Monitor (console.py)

Минимальный вывод:

* heartbeat (один символ на тик)
* age
* energy
* integrity

Пример:

```
• age=12.0s energy=98.8 integrity=1.00
```

---

## Параметры запуска

Через argparse:

* `--clear-data` (str, default="no") — очистка логов и snapshot перед стартом
* `--tick-interval` (float, default=1.0) — интервал тика, сек
* `--snapshot-period` (int, default=10) — периодичность snapshot, тиков
* `--dev` — включить dev mode с auto-reload

## Запуск

Команда:

```
python src/main_server_api.py --tick-interval 1.0 --snapshot-period 10
```

Для dev mode:

```
python src/main_server_api.py --dev
```

Ожидаемое поведение:

* процесс запускается
* API сервер на http://localhost:8000
* каждую секунду происходит тик
* параметры медленно деградируют
* snapshot сохраняются каждые 10 тиков
* при достижении порога life завершается

---

## Критерии успешности

Этап считается успешным, если:

* life существует без внешнего ввода
* параметры меняются со временем
* деградация необратима
* завершение происходит корректно

Если это достигнуто — система **уже живая** в архитектурном смысле.

---

## См. также

* [01_ARCHITECTURE.md](01_ARCHITECTURE.md) — общая архитектура
* [02_RUNTIME_LOOP.md](02_RUNTIME_LOOP.md) — цикл жизни
* [03_SELF_STATE.md](03_SELF_STATE.md) — внутреннее состояние
* [04_MONITOR.md](04_MONITOR.md) — система наблюдения
* [06_API_SERVER.md](06_API_SERVER.md) — API интерфейс

---

## Архитектурный инвариант этапа

> Ни одной строки кода сверх того, что описано здесь.

Если хочется добавить что-то ещё — значит этап не завершён.
