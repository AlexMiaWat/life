# Проект Life: Мини-документация для пользователя

## Что такое Life

**Life** — экспериментальная система искусственной жизни на Python, исследующая концепцию непрерывного существования вычислительной системы без целей и оптимизации.

### Ключевые принципы
- **Нет смерти — только слабость**: система работает даже при нулевых параметрах здоровья
- **Непрерывное существование**: процесс работает постоянно, накапливая состояние и историю
- **Медленные изменения**: все изменения происходят постепенно (макс. 0.01 за раз)
- **Без активного управления**: только реакция на события, без целеполагания

## Архитектура системы

### Слоеная архитектура
```
Environment → Runtime Loop → Self-State
                    ↓
Meaning Engine → Activation → Memory → Decision → Action → Feedback
                    ↓
Planning ← Intelligence ← Observability Layer
```

### Ключевые компоненты

#### 1. Runtime Loop (Сердцебиение)
- Центральный цикл с тиками
- Управляет менеджерами: SnapshotManager, LogManager, LifePolicy
- Обрабатывает события из очереди

#### 2. Self-State (Тело системы)
- Хранит состояние: energy, stability, integrity, age
- Накопление усталости и деградации
- Thread-safe доступ с валидацией

#### 3. Environment (Среда)
- Генератор событий: noise, decay, recovery, shock, idle
- Thread-safe очередь событий (max 100)
- CLI для ручной подачи событий

#### 4. Meaning Engine (Восприятие)
- Интерпретирует события: significance + impact
- Выбирает паттерн реакции: ignore/absorb/dampen/amplify

#### 5. Memory (Память)
- Эпизодическая память с забыванием
- Архивация и индексация
- Активация по типу события

#### 6. Cognitive Layers (Познание)
- **Decision**: выбор паттерна на основе памяти
- **Action**: выполнение действий с записью в память
- **Feedback**: фиксация последствий без оценки

#### 7. Higher Layers (Высшие слои)
- **Planning**: фиксация потенциальных последовательностей
- **Intelligence**: сбор метрик без интерпретации

#### 8. Observability Layer (Наблюдаемость)
- StructuredLogger: JSONL логирование всех стадий
- Корреляционные цепочки событий
- Метрики производительности (tick_duration, queue_size, etc.)

## Текущее состояние (2026-01-21)

### Реализованные этапы
- ✅ Этапы 00-13: Core, Environment, Meaning, Memory, Activation, Decision, Action, Feedback
- ✅ Этапы 17-18: Planning, Intelligence
- ✅ Архитектурные улучшения: Runtime Managers, Subjective Time, State Snapshots

### Тестирование
- **Всего тестов**: 780+ с 96% покрытием
- **Производительность**: ~15 мс на тик, 100+ ticks/sec
- **Качество кода**: Black, Pylint, MyPy, статический анализ

### Критические проблемы исправлены
- ✅ Shared state в ArchiveMemory
- ✅ API аутентификация упрощена
- ✅ Memory с забыванием и архивацией
- ✅ Learning/Adaptation интеграция

## Принципы и ограничения

### Архитектурные принципы
1. **Code-First подход**: сначала код, потом документация
2. **Изоляция слоев**: компоненты знают только о соседях
3. **Необратимость**: изменения нельзя отменить, только компенсировать
4. **Асинхронность**: среда живет независимо от системы

### Запрещенные концепции
- ❌ Цели и оптимизация поведения
- ❌ Активное управление и планирование
- ❌ Оценка и интерпретация (хорошо/плохо)
- ❌ Самосознание и воля

## Технологии и инструменты

### Стек технологий
- **Python 3.10+** с типизацией
- **FastAPI** для HTTP API
- **Threading** для многопоточности
- **JSON/JSONL** для сериализации

### Инструменты разработки
- **Тестирование**: pytest, hypothesis (property-based)
- **Качество**: Black, Pylint, MyPy, Isort
- **CI/CD**: GitHub Actions с pre-commit hooks
- **Профилирование**: cProfile для анализа производительности

### API эндпоинты
- `GET /status` — текущее состояние системы
- `POST /event` — подача события в очередь
- `GET /clear-data` — очистка логов и снапшотов
- `GET /refresh-cache` — обновление кэша

## Запуск и использование

### Быстрый старт
```bash
# Установка
pip install -r requirements.txt

# Запуск с API
python src/main_server_api.py --tick-interval 1.0 --snapshot-period 10

# Dev-режим с перезапуском
python src/main_server_api.py --dev

# Отправка события
curl -X POST http://localhost:8000/event \
  -H "Content-Type: application/json" \
  -d '{"type":"shock","intensity":-0.5}'
```

### Мониторинг
- Консоль: реальное время состояния
- Логи: `data/tick_log.jsonl` (JSONL)
- Снапшоты: `data/snapshots/` (каждые N тиков)

## Будущие планы

### Ближайшие цели
- **Learning (Этап 14)**: медленное изменение параметров
- **Adaptation (Этап 15)**: перестройка поведения
- **Memory v2.0**: улучшения забывания и индексации

### Долгосрочные улучшения
- Расширение тестирования (98%+ покрытие)
- Оптимизация производительности
- Улучшение документации и примеров

---

**Проект Life** — это исследование концепции жизни через непрерывное существование и адаптацию к деградации, без целей и оптимизации.