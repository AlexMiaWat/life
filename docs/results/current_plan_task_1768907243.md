# План выполнения задачи: Убрать/ограничить диагностические `print`-блоки в `src/main_server_api.py`

**Задача:** Убрать/ограничить диагностические `print`-блоки в `src/main_server_api.py` (оставить управляемый логгер)

**Дата создания:** 2026-01-20

## Анализ текущей ситуации

### Найденные диагностические print-блоки:

1. **Строки 23-28:** Диагностические print для monitor (тип, вызываемость, атрибуты)
   - Статус: УДАЛИТЬ (диагностика не нужна в production)

2. **Строки 162-164:** Print для POST /event (получение события)
   - Статус: ЗАМЕНИТЬ на logger.debug/info

3. **Строки 172-174:** Print для Event PUSHED (событие добавлено в очередь)
   - Статус: ЗАМЕНИТЬ на logger.debug/info

4. **Строки 186-216:** Print в `log_request()` для dev_mode
   - Статус: ОСТАВИТЬ (но заменить на logger.debug для dev_mode)

5. **Строка 225:** Print для запуска API сервера
   - Статус: ОСТАВИТЬ (важная информация для пользователя) или заменить на logger.info

6. **Строка 254:** Print для ошибки при отслеживании файлов
   - Статус: ЗАМЕНИТЬ на logger.error

7. **Строка 256:** Print для инициализации reloader
   - Статус: ЗАМЕНИТЬ на logger.info

8. **Строка 272:** Print для обнаружения изменений
   - Статус: ЗАМЕНИТЬ на logger.info

9. **Строки 297-302:** Print для диагностики перезагрузки модулей
   - Статус: ЗАМЕНИТЬ на logger.debug (только для dev_mode)

10. **Строка 321:** Print для перезагрузки модулей
    - Статус: ЗАМЕНИТЬ на logger.info

11. **Строка 363:** Print для очистки данных при старте
    - Статус: ЗАМЕНИТЬ на logger.info

12. **Строки 409-411:** Print для monitor (диагностика)
    - Статус: УДАЛИТЬ или заменить на logger.debug

13. **Строка 414:** Print для завершения loop
    - Статус: ОСТАВИТЬ (важная информация) или заменить на logger.info

14. **Строки 416-417:** Print для финального состояния
    - Статус: ОСТАВИТЬ (важная информация) или заменить на logger.info

## Стратегия замены

### Использование стандартного Python logging:

1. **Настроить logger** в начале файла:
   ```python
   import logging
   logger = logging.getLogger(__name__)
   ```

2. **Настроить уровень логирования** в зависимости от dev_mode:
   - В dev_mode: DEBUG уровень
   - В production: INFO уровень

3. **Категории замены:**
   - Диагностические print → УДАЛИТЬ или logger.debug
   - Информационные print → logger.info
   - Ошибки → logger.error
   - Важные сообщения для пользователя → можно оставить print или logger.info

## План действий

1. ✅ Изучить текущую реализацию print-блоков в `main_server_api.py`
2. ✅ Изучить использование logging в других модулях проекта
3. ✅ Создать план выполнения задачи
4. ⏳ Настроить logger в `main_server_api.py`
5. ⏳ Заменить диагностические print на logger.debug (или удалить)
6. ⏳ Заменить информационные print на logger.info
7. ⏳ Заменить print ошибок на logger.error
8. ⏳ Оставить важные print для пользователя (или заменить на logger.info)
9. ⏳ Настроить уровень логирования в зависимости от dev_mode
10. ⏳ Протестировать изменения
11. ⏳ Создать отчет о выполнении

## Детальный план замены

### Группа 1: Диагностические print (удалить или logger.debug)

- Строки 23-28: Диагностика monitor → УДАЛИТЬ
- Строки 297-302: Диагностика перезагрузки → logger.debug (только в dev_mode)
- Строки 409-411: Диагностика monitor → УДАЛИТЬ или logger.debug

### Группа 2: API логирование (logger.info/debug)

- Строки 162-164: POST /event → logger.debug
- Строки 172-174: Event PUSHED → logger.debug
- Строки 186-216: log_request → logger.debug (только в dev_mode)

### Группа 3: Системные сообщения (logger.info)

- Строка 225: API server running → logger.info
- Строка 256: Reloader initialized → logger.info
- Строка 272: Detected change → logger.info
- Строка 321: Modules reloaded → logger.info
- Строка 363: Очистка данных → logger.info
- Строка 414: Loop ended → logger.info
- Строки 416-417: Финальное состояние → logger.info

### Группа 4: Ошибки (logger.error)

- Строка 254: Error watching file → logger.error

## Выводы

Текущая реализация содержит множество диагностических print-блоков, которые:
1. Засоряют вывод в production
2. Не управляются через уровень логирования
3. Не могут быть отключены без изменения кода

После выполнения задачи:
- Все логирование будет управляемым через стандартный Python logging
- Уровень логирования будет настраиваться в зависимости от режима работы
- Диагностические print будут удалены или заменены на logger.debug
- Важные сообщения будут логироваться через logger.info/error
